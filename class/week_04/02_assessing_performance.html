
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Resampling &#8212; System &amp; AI 2022</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://esoreq.github.io/SystemAI2022/class/week_04/02_assessing_performance.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Home assignment : Ageing and Structural VBM" href="03_brainage.html" />
    <link rel="prev" title="Let’s cover some more basics" href="01_regression_models.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/figures_LOGO.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">System & AI 2022</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../about/system_and_ai_2022.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../about/bootcamp_intro.html">
   BOOT CAMP
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../bootcamp/day_01/00_day_01_overview.html">
     DAY 01 - basics
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_01/01_bash101.html">
       BASH 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_01/02_anaconda101.html">
       Anaconda environment 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_01/03_git101.html">
       Version control, git and github command line tools
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_01/04_jupyter_101.html">
       Jupyter notebooks 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_01/05_markdown_101.html">
       Markdown 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_01/06_homework.html">
       DAY 01 - HOMEWORK
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../bootcamp/day_02/00_day_02_overview.html">
     DAY 02 - Python
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_02/01_python_syntax_101.html">
       PYTHON SYNTAX 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_02/02_variables_101.html">
       PYTHON Basic Data Types
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_02/03_data_types.html">
       PYTHON Data operations 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_02/04_python_data_structures.html">
       PYTHON Data structures 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_02/05_programming_101.html">
       Python Programming 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_02/06_home_work.html">
       DAY 02 - HOMEWORK
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../bootcamp/day_03/00_day_03_overview.html">
     DAY 03 - Programming 101
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_03/01_python_functions_101.html">
       PYTHON FUNCTIONS 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_03/02_python_modules_101.html">
       PYTHON MODULES 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_03/03_anaconda_revisited.html">
       PYTHON ANACONDA 102
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_03/04_classes_in_python.html">
       PYTHON CLASSES 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_03/05_homework.html">
       DAY 03 - HOMEWORK
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../bootcamp/day_04/00_day_04_overview.html">
     DAY 04 - Numpy and Pandas 101
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_04/01_Numpy_data_structures.html">
       Numpy 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_04/02_Pandas_data_structures.html">
       Pandas 101
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_04/03_raw_to_tidy_with_pandas.html">
       From raw to structured
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_04/04_plotting_with_pandas.html">
       Plotting with pandas and Matplotlib
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_04/05_homework.html">
       DAY 04 - HOMEWORK
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../bootcamp/day_05/00_day_05_overview.html">
     DAY 05 - Data visualisation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_05/01_visual_perception.html">
       Graphical Representations of Data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../bootcamp/day_05/02_matplotlib_101.html">
       intro to matplotlib
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../about/setup.html">
   ⚙️ Course Setup
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week_01/00_overview.html">
   WEEK 01
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week_01/01_reproducibility.html">
     What is Open and Reproducible Research?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week_01/03_reproducibility_rules.html">
     Ten simple rules for reproducible research
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week_01/02_reproducibility_lab.html">
     Reproducibility lab
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week_02/00_overview.html">
   WEEK 02
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week_02/02_data_cleaning_lab.html">
     DATA Cleaning 101
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week_02/05_feature_engineering_lab.html">
     Feature Engineering and Feature Selection 101
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week_02/03_outlier_detection_lab.html">
     We start by creating several subset datasets
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week_03/00_overview.html">
   WEEK 03
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week_03/01_sklearn_101.html">
     Introducing Scikit-Learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week_03/02_pca.html">
     Principal Component Analysis (PCA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week_03/03_home_assignment.html">
     Home assignment
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="00_overview.html">
   WEEK 04
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_regression_models.html">
     Let’s cover some more basics
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Resampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_brainage.html">
     Home assignment : Ageing and Structural VBM
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week_05/00_overview.html">
   WEEK 05
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week_05/01_classification_models.html">
     Basic terminology
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/class/week_04/02_assessing_performance.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        <a class="issues-button"
            href="https://esoreq.github.io/SystemAI2022//issues/new?title=Issue%20on%20page%20%2Fclass/week_04/02_assessing_performance.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Resampling
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resampling-with-replacement">
     Resampling with replacement
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#preliminaries">
     Preliminaries
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relevant-statistical-formulas-you-should-all-know-by-now">
     Relevant Statistical Formulas (you should all know by now)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Resampling
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#types-of-probability-resampling-not-exhaustive">
   Types of Probability Resampling (not exhaustive)
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aspects-to-consider-when-performing-sampling">
   Aspects to consider when performing sampling
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#let-s-inject-some-code-to-the-theory">
   Let’s inject some code to the theory
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-sampling-each-element-of-the-population-has-an-equal-chance-of-being-selected">
     <strong>
      Random Sampling
     </strong>
     : Each element of the population has an equal chance of being selected.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#if-data-is-large">
       If data is large
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#with-replacement">
       <strong>
        With replacement
       </strong>
       :
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stratified-sampling">
     Stratified Sampling
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-are-we-resampling">
   Why are we resampling?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cross-validation">
   Cross-Validation
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-subset">
   Data Subset
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#common-types-of-cv">
   Common types of CV
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exhaustive-cv">
   Exhaustive CV
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#leave-p-out-cross-validation">
     Leave-p-out cross-validation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#leave-one-out-cross-validation">
     Leave-one-out cross-validation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#non-exhaustive-cv">
   Non-exhaustive CV
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#holdout-method">
     Holdout method
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#k-fold">
     K-Fold
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stratified-k-fold">
     Stratified k-fold
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comparing-models-using-a-pipeline">
     Comparing models using a pipeline
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Resampling</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Resampling
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resampling-with-replacement">
     Resampling with replacement
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#preliminaries">
     Preliminaries
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relevant-statistical-formulas-you-should-all-know-by-now">
     Relevant Statistical Formulas (you should all know by now)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Resampling
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#types-of-probability-resampling-not-exhaustive">
   Types of Probability Resampling (not exhaustive)
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aspects-to-consider-when-performing-sampling">
   Aspects to consider when performing sampling
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#let-s-inject-some-code-to-the-theory">
   Let’s inject some code to the theory
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-sampling-each-element-of-the-population-has-an-equal-chance-of-being-selected">
     <strong>
      Random Sampling
     </strong>
     : Each element of the population has an equal chance of being selected.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#if-data-is-large">
       If data is large
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#with-replacement">
       <strong>
        With replacement
       </strong>
       :
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stratified-sampling">
     Stratified Sampling
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-are-we-resampling">
   Why are we resampling?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cross-validation">
   Cross-Validation
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-subset">
   Data Subset
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#common-types-of-cv">
   Common types of CV
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exhaustive-cv">
   Exhaustive CV
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#leave-p-out-cross-validation">
     Leave-p-out cross-validation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#leave-one-out-cross-validation">
     Leave-one-out cross-validation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#non-exhaustive-cv">
   Non-exhaustive CV
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#holdout-method">
     Holdout method
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#k-fold">
     K-Fold
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stratified-k-fold">
     Stratified k-fold
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comparing-models-using-a-pipeline">
     Comparing models using a pipeline
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="resampling">
<h1>Resampling<a class="headerlink" href="#resampling" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Sampling with and without replacement</p></li>
<li><p>Cross validation and LOOCV</p></li>
<li><p>Bootstrap (using sampling with replacement)</p></li>
<li><p>Jackknife</p></li>
<li><p>Permutation resampling</p></li>
</ul>
<div class="section" id="resampling-with-replacement">
<h2>Resampling with replacement<a class="headerlink" href="#resampling-with-replacement" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="preliminaries">
<h2>Preliminaries<a class="headerlink" href="#preliminaries" title="Permalink to this headline">¶</a></h2>
<p>Our dataset can reflect either a population or sample (it is a function of context) of size N (i.e. the number of observations). In the univariate case, we define X as our dependent variable and x_i is a specific observation in that feature vector. There are various ways to take a sample, e.g. a simple random sample (SRS) of size n, where n &lt; N.</p>
<p>A <strong>population</strong> is the entire group that you want to draw conclusions about.</p>
<p>A <strong>sample</strong> is the specific subset of the population. The size of the sample is always less than the total size of the population.</p>
</div>
<div class="section" id="relevant-statistical-formulas-you-should-all-know-by-now">
<h2>Relevant Statistical Formulas (you should all know by now)<a class="headerlink" href="#relevant-statistical-formulas-you-should-all-know-by-now" title="Permalink to this headline">¶</a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Name</p></th>
<th class="text-align:left head"><p>Symbol</p></th>
<th class="text-align:center head"><p>Formula</p></th>
<th class="text-align:left head"><p><p width=10em>Pyhton</p></p></th>
<th class="text-align:left head"><p><p width=35%>description </p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>Mean</p></td>
<td class="text-align:left"><p>$<span class="math notranslate nohighlight">\(\mu\)</span>$</p></td>
<td class="text-align:center"><p>$<span class="math notranslate nohighlight">\(\mu = 1/N \sum_{i=1}^N x_i\)</span>$</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">mu</span> <span class="pre">=</span> <span class="pre">np.mean(x)</span></code></p></td>
<td class="text-align:left"><p>The population mean is an average of a group characteristic.</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Standard deviation (SD)</p></td>
<td class="text-align:left"><p>$<span class="math notranslate nohighlight">\(\sigma\)</span>$</p></td>
<td class="text-align:center"><p>$<span class="math notranslate nohighlight">\(\sigma = \sqrt{\frac{1}{N}\sum_{i=1}^{N}(x_{i}-\mu)^{2}}\)</span>$</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">sd</span> <span class="pre">=</span> <span class="pre">np.std(x)</span></code></p></td>
<td class="text-align:left"><p>The population standard deviation is the amount of variation or dispersion of a set of values.</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Proportion</p></td>
<td class="text-align:left"><p>$<span class="math notranslate nohighlight">\(\mu_{\hat{p}}\)</span>$</p></td>
<td class="text-align:center"><p>$<span class="math notranslate nohighlight">\(p = \frac{\sum x}{N} = \frac{\text {number of 1s}}{N}\)</span>$</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">=</span> <span class="pre">np.mean(x)</span></code></p></td>
<td class="text-align:left"><p>The population proportion is an average of a group characteristic for a binary value.</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Proportion (SD)</p></td>
<td class="text-align:left"><p>$<span class="math notranslate nohighlight">\(\sigma_{\hat{p}}\)</span>$</p></td>
<td class="text-align:center"><p>$<span class="math notranslate nohighlight">\(\sigma = \sqrt{p(1-p)}\)</span>$</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">sd</span> <span class="pre">=</span> <span class="pre">np.sqrt(p*(1-p))</span></code></p></td>
<td class="text-align:left"><p>The dispersion of the feature</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Degree of freedom</p></td>
<td class="text-align:left"><p>$<span class="math notranslate nohighlight">\(df\)</span>$</p></td>
<td class="text-align:center"><p>$<span class="math notranslate nohighlight">\(df = N - 1 - k\)</span>$</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">=</span> <span class="pre">X.shape[0]-1-X.shape[1]</span></code></p></td>
<td class="text-align:left"><p>The number of “observations” (pieces of information) in the data that are free to vary when estimating statistical parameters</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="id1">
<h1>Resampling<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>The process of selecting a subset(a predetermined number of observations) from a larger population.</p></li>
</ul>
<ol class="simple">
<li><p>Probability Sampling is when we choose a sample based on the theory of probability.</p></li>
<li><p>Non-Probability Sampling is when we choose a sample based on non-random criteria i.e. not every member of the population has a chance of being included (less relevant to our case).</p></li>
</ol>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="types-of-probability-resampling-not-exhaustive">
<h1>Types of Probability Resampling (not exhaustive)<a class="headerlink" href="#types-of-probability-resampling-not-exhaustive" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Simple Random Sampling: Samples are drawn with a uniform probability from the domain.</p></li>
<li><p>Stratified Sampling: Samples are drawn within pre-specified categories or factors.</p></li>
</ul>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="aspects-to-consider-when-performing-sampling">
<h1>Aspects to consider when performing sampling<a class="headerlink" href="#aspects-to-consider-when-performing-sampling" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Sample Goal. What is the metric you wish to estimate using the sample.</p></li>
<li><p>Population. Where are observations sampled or simulated from.</p></li>
<li><p>Selection Criteria. How do you select observations in each sample.</p></li>
<li><p>Sample Size. What is the number of observations that will constitute the sample.</p></li>
<li><p>Sample proportion. What multilevel factors are reflected in the sample</p></li>
</ul>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="let-s-inject-some-code-to-the-theory">
<h1>Let’s inject some code to the theory<a class="headerlink" href="#let-s-inject-some-code-to-the-theory" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">SEED</span> <span class="o">=</span> <span class="mi">2022</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1">#observations</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="random-sampling-each-element-of-the-population-has-an-equal-chance-of-being-selected">
<h2><strong>Random Sampling</strong>: Each element of the population has an equal chance of being selected.<a class="headerlink" href="#random-sampling-each-element-of-the-population-has-an-equal-chance-of-being-selected" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Each element in the population is equally likely to be selected but only once.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [2],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">X</span>

<span class="ne">NameError</span>: name &#39;X&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">sample_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># 10 obs over 5 folds </span>
<span class="n">subsets</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">subsets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">subsets</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">subsets</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral&#39;</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span> <span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/02_assessing_performance_5_1.png" src="../../_images/02_assessing_performance_5_1.png" />
</div>
</div>
<div class="section" id="if-data-is-large">
<h3>If data is large<a class="headerlink" href="#if-data-is-large" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">subsets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">sample_size</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">subsets</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral&#39;</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span> <span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/02_assessing_performance_7_1.png" src="../../_images/02_assessing_performance_7_1.png" />
</div>
</div>
</div>
<div class="section" id="with-replacement">
<h3><strong>With replacement</strong>:<a class="headerlink" href="#with-replacement" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>All elements of a population have an equal chance of being selected more than once - n can be larger than N in this example.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">sample_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># 20 obs over 5 folds </span>
<span class="n">subsets</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">subsets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">subsets</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">subsets</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral&#39;</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span> <span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/02_assessing_performance_9_1.png" src="../../_images/02_assessing_performance_9_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="stratified-sampling">
<h2>Stratified Sampling<a class="headerlink" href="#stratified-sampling" title="Permalink to this headline">¶</a></h2>
<p>Samples are drawn within pre-specified categories or factors.</p>
<ol class="simple">
<li><p>We group the entire population into subpopulations by some common property.</p></li>
<li><p>We then randomly sample from those groups individually, such that the groups are still maintained in the same ratio.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">ratio</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="n">folds</span><span class="p">,</span> <span class="n">sample_size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">subset_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span><span class="o">*</span><span class="n">sample_size</span>
<span class="n">dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">))[</span><span class="n">Y</span><span class="p">]</span>
<span class="n">subsets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">subset_size</span><span class="p">):</span>
    <span class="n">_X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dummy</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">subsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">_X</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">folds</span><span class="p">))))</span>
<span class="n">subsets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">subsets</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">subsets</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral&#39;</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span> <span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/02_assessing_performance_11_1.png" src="../../_images/02_assessing_performance_11_1.png" />
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="why-are-we-resampling">
<h1>Why are we resampling?<a class="headerlink" href="#why-are-we-resampling" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Resampling is intended to approximate the variability of some target metrics given some empirical conditions.</p></li>
<li><p>This, in turn, gives us the ability to conduct an empirical comparison within the limitations of our dataset.</p></li>
<li><p>It also allows us to augment our data in different forms (e.g. to handle imbalanced data or to introduce some heuristics to increase heterogeneity of the dataset)</p></li>
</ul>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="cross-validation">
<h1>Cross-Validation<a class="headerlink" href="#cross-validation" title="Permalink to this headline">¶</a></h1>
<p>A crucial part of machine learning is training the model. A model is created based on a set of data called the training set.
We then demonstrate the accuracy of the model on an unseen subset of the data, which is often referred to as a test or validation set.
Multiplication of independent subsets of training and, therefore, multiple models are extremely beneficial for many reasons. Each of these splits, however, may limit our model’s ability to learn a precise representation of the problem. This is sometimes a required feature of our learning pipeline (e.g. fitting age-band specific models as part of an ensemble learning algorithm). Generally, however, we will make use of all of our data (since it is very expensive to acquire).<br />
Unless manually constrained, models will grow in complexity in an attempt (often futile) to explain every data point. Usually, this kind of behaviour is called overfitting, and it can often be found in situations (at least in our field) when you have more observations than features (aka the “curse of dimensionality” or large P, small N, (P &gt;&gt; N)).
Generally, this means our model will be very good at predicting known situations, but it will struggle to generalize.
Using an iterative split and reporting mean performance over different iterations is one method of evaluating ML performance with minimal data sacrifice, as demonstrated last week. You may also look at the predictions we can make from unseen data. This process is called cross validation, i.e. learn from the training subset and test on the validation subset.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="data-subset">
<h1>Data Subset<a class="headerlink" href="#data-subset" title="Permalink to this headline">¶</a></h1>
<p>When selecting a model, we distinguish 3 different parts of the data that we have as follows:</p>
<ul class="simple">
<li><p>Training set (usualy 75-90% of the data) on which the model is trained</p></li>
<li><p>Validation set (usualy 25-10% of the data) on which the model is assessed (Also called hold-out or development set)</p></li>
<li><p>Testing set - the unseen data on which the perfomance of the model is reported</p></li>
</ul>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="common-types-of-cv">
<h1>Common types of CV<a class="headerlink" href="#common-types-of-cv" title="Permalink to this headline">¶</a></h1>
<p>Two types of cross-validation can be distinguished:</p>
<ul class="simple">
<li><p>Exhaustive</p></li>
<li><p>Non-exhaustive</p></li>
</ul>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="exhaustive-cv">
<h1>Exhaustive CV<a class="headerlink" href="#exhaustive-cv" title="Permalink to this headline">¶</a></h1>
<p>methods which learn and test on all possible ways to divide the original sample into a training and a validation set.</p>
<div class="section" id="leave-p-out-cross-validation">
<h2>Leave-p-out cross-validation<a class="headerlink" href="#leave-p-out-cross-validation" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Creates all the possible training/test sets by removing p samples from the complete set. For n samples, this produces n over p train-test pairs.</p></li>
<li><p>Let’s view this visually</p></li>
<li><p>For example take 20/80% split</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">LeavePOut</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;xticklabels&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;yticklabels&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;annot&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
          <span class="s2">&quot;cbar&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
          <span class="s2">&quot;linewidths&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s1">&#39;cmap&#39;</span><span class="p">:</span> <span class="s1">&#39;Paired&#39;</span><span class="p">}</span>
<span class="n">Leave_p</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">N_test</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">Leave_p</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">lpo</span><span class="o">=</span><span class="n">LeavePOut</span><span class="p">(</span><span class="n">N_test</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lpo</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">Y</span><span class="p">)):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">tmp</span><span class="p">[</span><span class="n">test</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>  <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of splits&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Number of observations&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(82.5, 0.5, &#39;Number of observations&#39;)
</pre></div>
</div>
<img alt="../../_images/02_assessing_performance_14_1.png" src="../../_images/02_assessing_performance_14_1.png" />
</div>
</div>
<ul class="simple">
<li><p>Due to the high number of iterations which grows combinatorially with the number of samples this cross-validation method can be very costly.</p></li>
</ul>
</div>
<div class="section" id="leave-one-out-cross-validation">
<h2>Leave-one-out cross-validation<a class="headerlink" href="#leave-one-out-cross-validation" title="Permalink to this headline">¶</a></h2>
<p>Leave-one-out cross-validation (LOOCV) is a particular case of leave-p-out cross-validation with p = 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">lpo</span> <span class="o">=</span> <span class="n">LeavePOut</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lpo</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">Y</span><span class="p">)):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">tmp</span><span class="p">[</span><span class="n">test</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>  <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of splits&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Number of observations&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(82.5, 0.5, &#39;Number of observations&#39;)
</pre></div>
</div>
<img alt="../../_images/02_assessing_performance_16_1.png" src="../../_images/02_assessing_performance_16_1.png" />
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="non-exhaustive-cv">
<h1>Non-exhaustive CV<a class="headerlink" href="#non-exhaustive-cv" title="Permalink to this headline">¶</a></h1>
<p>Methods which learn and test on a subset (often overlapping) of all possible ways to divide the original sample (we are approximating the performance using some assumptions).</p>
<div class="section" id="holdout-method">
<h2>Holdout method<a class="headerlink" href="#holdout-method" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>We randomly assign data points to two sets d0 and d1, usually referred to as training and testing sets. Usually, the test set is smaller than the training set, but it’s not set in stone. Training (building a model) on d0, testing (evaluating it) on d1.</p></li>
<li><p>Cross-validation typically involves averaging the results of several model-testing runs; by contrast, holdout involves only a single run. In fact, if the multiple runs are not averaged, you may achieve highly misinforming results without such averaging.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">Y</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2022</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span>
    <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width_ratios&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">]})</span>
<span class="n">params</span><span class="p">[</span><span class="s1">&#39;cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Paired&#39;</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">y_train</span><span class="p">,(</span><span class="n">y_test</span><span class="o">+</span><span class="mi">3</span><span class="p">)])),</span>  <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">X_train</span><span class="p">,(</span><span class="n">X_test</span><span class="o">+</span><span class="mi">5</span><span class="p">)])),</span>  <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/02_assessing_performance_18_1.png" src="../../_images/02_assessing_performance_18_1.png" />
</div>
</div>
</div>
<div class="section" id="k-fold">
<h2>K-Fold<a class="headerlink" href="#k-fold" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Split the dataset into k groups of samples, called folds (if k=n, this is equivalent to the Leave One Out strategy), of equal sizes (if possible).</p></li>
<li><p>The prediction function is learned using  folds, and the fold left out is used for test.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">Y</span><span class="p">)):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">tmp</span><span class="p">[</span><span class="n">test</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>  <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Number of folds&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of observations&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 28.5, &#39;Number of observations&#39;)
</pre></div>
</div>
<img alt="../../_images/02_assessing_performance_20_1.png" src="../../_images/02_assessing_performance_20_1.png" />
</div>
</div>
</div>
<div class="section" id="stratified-k-fold">
<h2>Stratified k-fold<a class="headerlink" href="#stratified-k-fold" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Stratified k-fold is a variation of k-fold which returns stratified folds.</p></li>
<li><p>each set contains approximately the same ratio of samples of each target class as the complete set.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">skf</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="n">params</span><span class="p">[</span><span class="s2">&quot;linewidths&quot;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">skf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span>
        <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width_ratios&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">]})</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">C</span><span class="p">[</span><span class="n">train</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">params</span><span class="p">[</span><span class="s1">&#39;cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Paired&#39;</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Y</span><span class="o">+</span><span class="n">Y</span><span class="o">*</span><span class="n">C</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>  <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">params</span><span class="p">[</span><span class="s1">&#39;cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Blues&#39;</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="n">X</span><span class="o">*</span><span class="n">C</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>  <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/02_assessing_performance_22_0.png" src="../../_images/02_assessing_performance_22_0.png" />
<img alt="../../_images/02_assessing_performance_22_1.png" src="../../_images/02_assessing_performance_22_1.png" />
</div>
</div>
</div>
<div class="section" id="comparing-models-using-a-pipeline">
<h2>Comparing models using a pipeline<a class="headerlink" href="#comparing-models-using-a-pipeline" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_diabetes</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span><span class="n">Markdown</span>
<span class="n">diabetes</span> <span class="o">=</span> <span class="n">load_diabetes</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">diabetes</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span><span class="n">columns</span><span class="o">=</span> <span class="n">diabetes</span><span class="p">[</span><span class="s1">&#39;feature_names&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">diabetes</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="n">diabetes</span><span class="p">[</span><span class="s1">&#39;DESCR&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<p>.. _diabetes_dataset:</p>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/home/runner/work/SystemAI2022/SystemAI2022/class/week_04/02_assessing_performance.ipynb</span>, line 3)</p>
<p>Non-consecutive header level increase; 0 to 2 [myst.header]</p>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">VarianceThreshold</span> <span class="c1"># Feature selector</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">Normalizer</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">PowerTransformer</span><span class="p">,</span> <span class="n">MaxAbsScaler</span><span class="p">,</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span> <span class="c1"># For optimization</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectKBest</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span><span class="n">mean_squared_error</span><span class="p">,</span><span class="n">r2_score</span><span class="p">,</span><span class="n">median_absolute_error</span>
<span class="k">def</span> <span class="nf">calc_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">y_hat</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">):</span>
    <span class="n">err</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Kind&#39;</span><span class="p">:</span><span class="n">kind</span><span class="p">,</span>
            <span class="s1">&#39;MAE&#39;</span><span class="p">:</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">y_hat</span><span class="p">),</span>
            <span class="s1">&#39;MSE&#39;</span><span class="p">:</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">y_hat</span><span class="p">),</span>
            <span class="s1">&#39;MAD&#39;</span><span class="p">:</span><span class="n">median_absolute_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">y_hat</span><span class="p">),</span>
            <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">y_hat</span><span class="p">,</span><span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
            <span class="s1">&#39;r2&#39;</span><span class="p">:</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">y_hat</span><span class="p">)}</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2022</span><span class="p">)</span>
<span class="c1"># Linear Regression Pipeline</span>
<span class="n">lr_pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;mdl&#39;</span><span class="p">,</span><span class="n">LinearRegression</span><span class="p">())])</span>
<span class="n">lr_pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">y_hat</span> <span class="o">=</span> <span class="n">lr_pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">calc_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span><span class="n">y_hat</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Kind</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAD</th>
      <th>RMSE</th>
      <th>r2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>None</th>
      <td>model</td>
      <td>44.145585</td>
      <td>2911.802823</td>
      <td>38.222455</td>
      <td>53.961123</td>
      <td>0.520596</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr_pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scl&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
                    <span class="p">(</span><span class="s1">&#39;poly_expansion&#39;</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span>                                     
                    <span class="p">(</span><span class="s1">&#39;mdl&#39;</span><span class="p">,</span><span class="n">LinearRegression</span><span class="p">())])</span>
<span class="n">lr_pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">y_hat</span> <span class="o">=</span> <span class="n">lr_pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">calc_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span><span class="n">y_hat</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Kind</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAD</th>
      <th>RMSE</th>
      <th>r2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>None</th>
      <td>model</td>
      <td>43.383252</td>
      <td>3315.424821</td>
      <td>33.361328</td>
      <td>57.579726</td>
      <td>0.454143</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">residual</span> <span class="o">=</span> <span class="n">Y_test</span> <span class="o">-</span> <span class="n">y_hat</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">residual</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">residual</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x17b7c4f70&gt;
</pre></div>
</div>
<img alt="../../_images/02_assessing_performance_27_1.png" src="../../_images/02_assessing_performance_27_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr_pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scl&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
                    <span class="p">(</span><span class="s1">&#39;reduce_dim&#39;</span><span class="p">,</span> <span class="n">PCA</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span>                                     
                    <span class="p">(</span><span class="s1">&#39;mdl&#39;</span><span class="p">,</span><span class="n">LinearRegression</span><span class="p">())])</span>
<span class="n">lr_pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">y_hat</span> <span class="o">=</span> <span class="n">lr_pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">calc_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span><span class="n">y_hat</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Kind</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAD</th>
      <th>RMSE</th>
      <th>r2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>None</th>
      <td>model</td>
      <td>44.880766</td>
      <td>2889.91989</td>
      <td>37.997576</td>
      <td>53.757975</td>
      <td>0.524199</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
          <span class="p">(</span><span class="s1">&#39;reduce_dim&#39;</span><span class="p">,</span> <span class="s1">&#39;passthrough&#39;</span><span class="p">),</span>                                     
          <span class="p">(</span><span class="s1">&#39;poly_expansion&#39;</span><span class="p">,</span> <span class="s1">&#39;passthrough&#39;</span><span class="p">),</span>
          <span class="p">(</span><span class="s1">&#39;mdl&#39;</span><span class="p">,</span><span class="n">LinearRegression</span><span class="p">())])</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="p">[</span><span class="n">StandardScaler</span><span class="p">(),</span><span class="n">PowerTransformer</span><span class="p">()],</span>
    <span class="n">reduce_dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;passthrough&#39;</span><span class="p">,</span> <span class="n">PCA</span><span class="p">(</span><span class="mi">5</span><span class="p">)],</span>
    <span class="n">poly_expansion</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;passthrough&#39;</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span>
    <span class="n">mdl</span> <span class="o">=</span> <span class="p">[</span><span class="n">LinearRegression</span><span class="p">(),</span><span class="n">DecisionTreeRegressor</span><span class="p">(),</span>
           <span class="n">SVR</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span><span class="n">SVR</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">1000</span><span class="p">)]</span>
<span class="p">)</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">grid_search</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;rank_test_score&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_fit_time</th>
      <th>std_fit_time</th>
      <th>mean_score_time</th>
      <th>std_score_time</th>
      <th>param_mdl</th>
      <th>param_poly_expansion</th>
      <th>param_reduce_dim</th>
      <th>param_scaler</th>
      <th>params</th>
      <th>split0_test_score</th>
      <th>split1_test_score</th>
      <th>split2_test_score</th>
      <th>split3_test_score</th>
      <th>split4_test_score</th>
      <th>mean_test_score</th>
      <th>std_test_score</th>
      <th>rank_test_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.005297</td>
      <td>0.000942</td>
      <td>0.001844</td>
      <td>0.000523</td>
      <td>LinearRegression()</td>
      <td>passthrough</td>
      <td>passthrough</td>
      <td>StandardScaler()</td>
      <td>{'mdl': LinearRegression(), 'poly_expansion': ...</td>
      <td>0.469886</td>
      <td>0.414581</td>
      <td>0.492662</td>
      <td>0.512901</td>
      <td>0.388028</td>
      <td>0.455612</td>
      <td>0.047137</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.006388</td>
      <td>0.001565</td>
      <td>0.002252</td>
      <td>0.000651</td>
      <td>LinearRegression()</td>
      <td>passthrough</td>
      <td>PCA(n_components=5)</td>
      <td>StandardScaler()</td>
      <td>{'mdl': LinearRegression(), 'poly_expansion': ...</td>
      <td>0.500157</td>
      <td>0.417215</td>
      <td>0.459713</td>
      <td>0.544992</td>
      <td>0.346969</td>
      <td>0.453809</td>
      <td>0.068193</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.029924</td>
      <td>0.005845</td>
      <td>0.002475</td>
      <td>0.000387</td>
      <td>LinearRegression()</td>
      <td>passthrough</td>
      <td>PCA(n_components=5)</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': LinearRegression(), 'poly_expansion': ...</td>
      <td>0.483130</td>
      <td>0.406608</td>
      <td>0.452395</td>
      <td>0.539718</td>
      <td>0.350204</td>
      <td>0.446411</td>
      <td>0.064700</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.038073</td>
      <td>0.011869</td>
      <td>0.004389</td>
      <td>0.002446</td>
      <td>LinearRegression()</td>
      <td>passthrough</td>
      <td>passthrough</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': LinearRegression(), 'poly_expansion': ...</td>
      <td>0.439101</td>
      <td>0.391590</td>
      <td>0.493332</td>
      <td>0.507906</td>
      <td>0.378505</td>
      <td>0.442087</td>
      <td>0.052076</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.006284</td>
      <td>0.000768</td>
      <td>0.002452</td>
      <td>0.000276</td>
      <td>LinearRegression()</td>
      <td>PolynomialFeatures()</td>
      <td>PCA(n_components=5)</td>
      <td>StandardScaler()</td>
      <td>{'mdl': LinearRegression(), 'poly_expansion': ...</td>
      <td>0.523651</td>
      <td>0.368110</td>
      <td>0.454491</td>
      <td>0.531652</td>
      <td>0.328744</td>
      <td>0.441330</td>
      <td>0.081418</td>
      <td>5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.033421</td>
      <td>0.001978</td>
      <td>0.002939</td>
      <td>0.000387</td>
      <td>LinearRegression()</td>
      <td>PolynomialFeatures()</td>
      <td>PCA(n_components=5)</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': LinearRegression(), 'poly_expansion': ...</td>
      <td>0.525636</td>
      <td>0.364419</td>
      <td>0.446595</td>
      <td>0.534919</td>
      <td>0.325334</td>
      <td>0.439381</td>
      <td>0.083959</td>
      <td>6</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.009736</td>
      <td>0.000614</td>
      <td>0.004000</td>
      <td>0.000220</td>
      <td>SVR(C=100)</td>
      <td>passthrough</td>
      <td>PCA(n_components=5)</td>
      <td>StandardScaler()</td>
      <td>{'mdl': SVR(C=100), 'poly_expansion': 'passthr...</td>
      <td>0.518726</td>
      <td>0.437114</td>
      <td>0.434417</td>
      <td>0.504068</td>
      <td>0.287560</td>
      <td>0.436377</td>
      <td>0.081871</td>
      <td>7</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.009666</td>
      <td>0.000266</td>
      <td>0.004268</td>
      <td>0.000381</td>
      <td>SVR(C=100)</td>
      <td>passthrough</td>
      <td>passthrough</td>
      <td>StandardScaler()</td>
      <td>{'mdl': SVR(C=100), 'poly_expansion': 'passthr...</td>
      <td>0.524250</td>
      <td>0.422386</td>
      <td>0.491429</td>
      <td>0.426068</td>
      <td>0.301601</td>
      <td>0.433147</td>
      <td>0.076376</td>
      <td>8</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.031136</td>
      <td>0.001707</td>
      <td>0.004613</td>
      <td>0.000217</td>
      <td>SVR(C=100)</td>
      <td>passthrough</td>
      <td>PCA(n_components=5)</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': SVR(C=100), 'poly_expansion': 'passthr...</td>
      <td>0.482814</td>
      <td>0.419219</td>
      <td>0.421437</td>
      <td>0.522806</td>
      <td>0.289662</td>
      <td>0.427188</td>
      <td>0.079053</td>
      <td>9</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.030605</td>
      <td>0.001148</td>
      <td>0.004910</td>
      <td>0.000359</td>
      <td>SVR(C=100)</td>
      <td>passthrough</td>
      <td>passthrough</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': SVR(C=100), 'poly_expansion': 'passthr...</td>
      <td>0.491992</td>
      <td>0.408773</td>
      <td>0.477814</td>
      <td>0.430682</td>
      <td>0.282593</td>
      <td>0.418371</td>
      <td>0.074341</td>
      <td>10</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0.010963</td>
      <td>0.000811</td>
      <td>0.004647</td>
      <td>0.000230</td>
      <td>SVR(C=100)</td>
      <td>PolynomialFeatures()</td>
      <td>PCA(n_components=5)</td>
      <td>StandardScaler()</td>
      <td>{'mdl': SVR(C=100), 'poly_expansion': Polynomi...</td>
      <td>0.446643</td>
      <td>0.385414</td>
      <td>0.349174</td>
      <td>0.504989</td>
      <td>0.283795</td>
      <td>0.394003</td>
      <td>0.076574</td>
      <td>11</td>
    </tr>
    <tr>
      <th>20</th>
      <td>0.011107</td>
      <td>0.000840</td>
      <td>0.006818</td>
      <td>0.000910</td>
      <td>SVR(C=100)</td>
      <td>PolynomialFeatures()</td>
      <td>passthrough</td>
      <td>StandardScaler()</td>
      <td>{'mdl': SVR(C=100), 'poly_expansion': Polynomi...</td>
      <td>0.440862</td>
      <td>0.401638</td>
      <td>0.402375</td>
      <td>0.416467</td>
      <td>0.256513</td>
      <td>0.383571</td>
      <td>0.065097</td>
      <td>12</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0.033296</td>
      <td>0.001491</td>
      <td>0.005245</td>
      <td>0.000542</td>
      <td>SVR(C=100)</td>
      <td>PolynomialFeatures()</td>
      <td>PCA(n_components=5)</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': SVR(C=100), 'poly_expansion': Polynomi...</td>
      <td>0.431164</td>
      <td>0.369638</td>
      <td>0.320978</td>
      <td>0.504165</td>
      <td>0.282127</td>
      <td>0.381614</td>
      <td>0.078983</td>
      <td>13</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0.032999</td>
      <td>0.002133</td>
      <td>0.007454</td>
      <td>0.000888</td>
      <td>SVR(C=100)</td>
      <td>PolynomialFeatures()</td>
      <td>passthrough</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': SVR(C=100), 'poly_expansion': Polynomi...</td>
      <td>0.429430</td>
      <td>0.387670</td>
      <td>0.371002</td>
      <td>0.380627</td>
      <td>0.271917</td>
      <td>0.368129</td>
      <td>0.052079</td>
      <td>14</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0.021853</td>
      <td>0.001065</td>
      <td>0.004051</td>
      <td>0.000202</td>
      <td>SVR(C=1000)</td>
      <td>passthrough</td>
      <td>PCA(n_components=5)</td>
      <td>StandardScaler()</td>
      <td>{'mdl': SVR(C=1000), 'poly_expansion': 'passth...</td>
      <td>0.387123</td>
      <td>0.350119</td>
      <td>0.277183</td>
      <td>0.301152</td>
      <td>0.135033</td>
      <td>0.290122</td>
      <td>0.086430</td>
      <td>15</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0.043514</td>
      <td>0.001980</td>
      <td>0.004703</td>
      <td>0.000261</td>
      <td>SVR(C=1000)</td>
      <td>passthrough</td>
      <td>PCA(n_components=5)</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': SVR(C=1000), 'poly_expansion': 'passth...</td>
      <td>0.343140</td>
      <td>0.348840</td>
      <td>0.297401</td>
      <td>0.308156</td>
      <td>0.149251</td>
      <td>0.289358</td>
      <td>0.072772</td>
      <td>16</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.019641</td>
      <td>0.001794</td>
      <td>0.004731</td>
      <td>0.000672</td>
      <td>SVR(C=1000)</td>
      <td>PolynomialFeatures()</td>
      <td>PCA(n_components=5)</td>
      <td>StandardScaler()</td>
      <td>{'mdl': SVR(C=1000), 'poly_expansion': Polynom...</td>
      <td>0.328915</td>
      <td>0.274953</td>
      <td>0.124144</td>
      <td>0.300258</td>
      <td>0.214994</td>
      <td>0.248653</td>
      <td>0.072708</td>
      <td>17</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0.041920</td>
      <td>0.001917</td>
      <td>0.005450</td>
      <td>0.000192</td>
      <td>SVR(C=1000)</td>
      <td>PolynomialFeatures()</td>
      <td>PCA(n_components=5)</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': SVR(C=1000), 'poly_expansion': Polynom...</td>
      <td>0.346005</td>
      <td>0.171278</td>
      <td>0.111863</td>
      <td>0.276609</td>
      <td>0.236536</td>
      <td>0.228458</td>
      <td>0.081321</td>
      <td>18</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0.018177</td>
      <td>0.001004</td>
      <td>0.006713</td>
      <td>0.000414</td>
      <td>SVR(C=1000)</td>
      <td>PolynomialFeatures()</td>
      <td>passthrough</td>
      <td>StandardScaler()</td>
      <td>{'mdl': SVR(C=1000), 'poly_expansion': Polynom...</td>
      <td>0.376874</td>
      <td>0.182451</td>
      <td>0.193284</td>
      <td>0.141923</td>
      <td>0.074027</td>
      <td>0.193712</td>
      <td>0.100679</td>
      <td>19</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0.042055</td>
      <td>0.001907</td>
      <td>0.007029</td>
      <td>0.000200</td>
      <td>SVR(C=1000)</td>
      <td>PolynomialFeatures()</td>
      <td>passthrough</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': SVR(C=1000), 'poly_expansion': Polynom...</td>
      <td>0.348856</td>
      <td>0.131184</td>
      <td>0.135310</td>
      <td>0.095024</td>
      <td>0.079884</td>
      <td>0.158052</td>
      <td>0.097702</td>
      <td>20</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0.044435</td>
      <td>0.001069</td>
      <td>0.004790</td>
      <td>0.000234</td>
      <td>SVR(C=1000)</td>
      <td>passthrough</td>
      <td>passthrough</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': SVR(C=1000), 'poly_expansion': 'passth...</td>
      <td>0.339580</td>
      <td>0.237384</td>
      <td>0.222567</td>
      <td>-0.026142</td>
      <td>-0.010650</td>
      <td>0.152547</td>
      <td>0.145358</td>
      <td>21</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0.026006</td>
      <td>0.003578</td>
      <td>0.004104</td>
      <td>0.000112</td>
      <td>SVR(C=1000)</td>
      <td>passthrough</td>
      <td>passthrough</td>
      <td>StandardScaler()</td>
      <td>{'mdl': SVR(C=1000), 'poly_expansion': 'passth...</td>
      <td>0.372247</td>
      <td>0.233174</td>
      <td>0.220424</td>
      <td>-0.115221</td>
      <td>0.021848</td>
      <td>0.146494</td>
      <td>0.172032</td>
      <td>22</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.041963</td>
      <td>0.010728</td>
      <td>0.003880</td>
      <td>0.001115</td>
      <td>LinearRegression()</td>
      <td>PolynomialFeatures()</td>
      <td>passthrough</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': LinearRegression(), 'poly_expansion': ...</td>
      <td>0.494102</td>
      <td>0.071170</td>
      <td>0.287694</td>
      <td>-0.483298</td>
      <td>0.211702</td>
      <td>0.116274</td>
      <td>0.329474</td>
      <td>23</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.029324</td>
      <td>0.001670</td>
      <td>0.002642</td>
      <td>0.000078</td>
      <td>DecisionTreeRegressor()</td>
      <td>PolynomialFeatures()</td>
      <td>PCA(n_components=5)</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': DecisionTreeRegressor(), 'poly_expansi...</td>
      <td>0.148173</td>
      <td>-0.155909</td>
      <td>0.068890</td>
      <td>-0.151454</td>
      <td>0.100249</td>
      <td>0.001990</td>
      <td>0.129597</td>
      <td>24</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.027211</td>
      <td>0.001793</td>
      <td>0.002526</td>
      <td>0.000301</td>
      <td>DecisionTreeRegressor()</td>
      <td>passthrough</td>
      <td>PCA(n_components=5)</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': DecisionTreeRegressor(), 'poly_expansi...</td>
      <td>0.073704</td>
      <td>-0.301462</td>
      <td>-0.063772</td>
      <td>0.013898</td>
      <td>0.007968</td>
      <td>-0.053933</td>
      <td>0.131219</td>
      <td>25</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.012866</td>
      <td>0.000605</td>
      <td>0.002682</td>
      <td>0.000957</td>
      <td>DecisionTreeRegressor()</td>
      <td>PolynomialFeatures()</td>
      <td>passthrough</td>
      <td>StandardScaler()</td>
      <td>{'mdl': DecisionTreeRegressor(), 'poly_expansi...</td>
      <td>-0.052544</td>
      <td>-0.362405</td>
      <td>0.020946</td>
      <td>0.143716</td>
      <td>-0.216992</td>
      <td>-0.093456</td>
      <td>0.178105</td>
      <td>26</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.034781</td>
      <td>0.001258</td>
      <td>0.003420</td>
      <td>0.000883</td>
      <td>DecisionTreeRegressor()</td>
      <td>PolynomialFeatures()</td>
      <td>passthrough</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': DecisionTreeRegressor(), 'poly_expansi...</td>
      <td>0.102716</td>
      <td>-0.100929</td>
      <td>-0.250472</td>
      <td>-0.025975</td>
      <td>-0.316086</td>
      <td>-0.118149</td>
      <td>0.151170</td>
      <td>27</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.004779</td>
      <td>0.000357</td>
      <td>0.001953</td>
      <td>0.000433</td>
      <td>DecisionTreeRegressor()</td>
      <td>passthrough</td>
      <td>PCA(n_components=5)</td>
      <td>StandardScaler()</td>
      <td>{'mdl': DecisionTreeRegressor(), 'poly_expansi...</td>
      <td>0.229728</td>
      <td>-0.563812</td>
      <td>-0.114719</td>
      <td>-0.036201</td>
      <td>-0.136083</td>
      <td>-0.124217</td>
      <td>0.255538</td>
      <td>28</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.007214</td>
      <td>0.000540</td>
      <td>0.001788</td>
      <td>0.000098</td>
      <td>DecisionTreeRegressor()</td>
      <td>PolynomialFeatures()</td>
      <td>PCA(n_components=5)</td>
      <td>StandardScaler()</td>
      <td>{'mdl': DecisionTreeRegressor(), 'poly_expansi...</td>
      <td>0.080670</td>
      <td>-0.125842</td>
      <td>-0.443180</td>
      <td>0.009932</td>
      <td>-0.202422</td>
      <td>-0.136168</td>
      <td>0.182820</td>
      <td>29</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.005019</td>
      <td>0.000226</td>
      <td>0.001793</td>
      <td>0.000366</td>
      <td>DecisionTreeRegressor()</td>
      <td>passthrough</td>
      <td>passthrough</td>
      <td>StandardScaler()</td>
      <td>{'mdl': DecisionTreeRegressor(), 'poly_expansi...</td>
      <td>0.126046</td>
      <td>-0.100575</td>
      <td>-0.282734</td>
      <td>-0.366028</td>
      <td>-0.321156</td>
      <td>-0.188889</td>
      <td>0.181473</td>
      <td>30</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.027610</td>
      <td>0.002342</td>
      <td>0.002448</td>
      <td>0.000236</td>
      <td>DecisionTreeRegressor()</td>
      <td>passthrough</td>
      <td>passthrough</td>
      <td>PowerTransformer()</td>
      <td>{'mdl': DecisionTreeRegressor(), 'poly_expansi...</td>
      <td>0.225420</td>
      <td>-0.147166</td>
      <td>-0.273759</td>
      <td>-0.395750</td>
      <td>-0.478908</td>
      <td>-0.214033</td>
      <td>0.246713</td>
      <td>31</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.028424</td>
      <td>0.038944</td>
      <td>0.002975</td>
      <td>0.000607</td>
      <td>LinearRegression()</td>
      <td>PolynomialFeatures()</td>
      <td>passthrough</td>
      <td>StandardScaler()</td>
      <td>{'mdl': LinearRegression(), 'poly_expansion': ...</td>
      <td>-27.050037</td>
      <td>0.069305</td>
      <td>0.285869</td>
      <td>0.243016</td>
      <td>0.258598</td>
      <td>-5.238650</td>
      <td>10.905959</td>
      <td>32</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_pipe</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span>


<span class="n">display</span><span class="p">(</span><span class="n">calc_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span><span class="n">best_pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Kind</th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAD</th>
      <th>RMSE</th>
      <th>r2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>None</th>
      <td>model</td>
      <td>44.145585</td>
      <td>2911.802823</td>
      <td>38.222455</td>
      <td>53.961123</td>
      <td>0.520596</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_hat</span> <span class="o">=</span> <span class="n">best_pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">residual</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">Y_test</span><span class="o">-</span><span class="n">y_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">residual</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">residual</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span><span class="n">y_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x17aa89f60&gt;
</pre></div>
</div>
<img alt="../../_images/02_assessing_performance_33_1.png" src="../../_images/02_assessing_performance_33_1.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./class/week_04"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="01_regression_models.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Let’s cover some more basics</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="03_brainage.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Home assignment : Ageing and Structural VBM</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Eyal Soreq<br/>
    
        &copy; Copyright 2021.<br/>
      <div class="extra_footer">
        <div>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://licensebuttons.net/l/by-nc-sa/3.0/88x31.png"></a>
    All content on this site (unless otherwise specified) is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0 license</a>
</div>

      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>